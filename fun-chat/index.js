(()=>{"use strict";var e={845:(e,s,t)=>{s.PL=void 0;const n=t(895);s.PL=new class{storageKeyPrefix;constructor(e){this.storageKeyPrefix=e}getStorageKey(e){return`${this.storageKeyPrefix}_${e}`}saveData(e,s){const t=this.getStorageKey(e);sessionStorage.setItem(t,JSON.stringify(s))}getData(e){const s=this.getStorageKey(e),t=sessionStorage.getItem(s);return t?JSON.parse(t):null}removeData(e){const s=this.getStorageKey(e);sessionStorage.removeItem(s)}}(n.STORAGE_KEY)},895:(e,s,t)=>{t.r(s),t.d(s,{ABOUT_APP_TEXT:()=>E,AUTH_DATA_KEY:()=>p,CONNECTION_CHECK_INTERVAL:()=>A,INVALID_CHARS_TEXT:()=>g,INVALID_LETTER_TEXT:()=>u,LOGIN_MIN_LENGTH:()=>m,MESSAGE_USER_ALIAS:()=>S,PASSWORD_MIN_LENGTH:()=>w,PUBLIC_PATH:()=>M,RECONNECTION_ERROR_TEXT:()=>y,SERVER_ADDRESS:()=>n,SERVER_PORT:()=>a,STORAGE_KEY:()=>h,attributeKeys:()=>b,classSelectors:()=>d,classes:()=>c,errorsNames:()=>i,historyPlaceholders:()=>C,messageStatuses:()=>B,pagesPaths:()=>N,serverResponseTypes:()=>r,userStatuses:()=>v,webServiceMessages:()=>o,webSocketReadyStates:()=>l});const n="127.0.0.1",a="4000",A=500,r={userLogin:"USER_LOGIN",error:"ERROR",userLogout:"USER_LOGOUT",userExternalLogin:"USER_EXTERNAL_LOGIN",userExternalLogout:"USER_EXTERNAL_LOGOUT",userActive:"USER_ACTIVE",userInactive:"USER_INACTIVE",msgSend:"MSG_SEND",msgFromUser:"MSG_FROM_USER",msgDeliver:"MSG_DELIVER",msgRead:"MSG_READ",msgRead:"MSG_READ",error:"ERROR",msgDelete:"MSG_DELETE",msgEdit:"MSG_EDIT"},o={onOpen:"Connection established",onClose:"Connection closed",connectionError:"Connection error occured",noDataInResponse:"No data in response or request:",taskAborted:"Connection service operation aborted",noConnection:"No active connection"},i={connectionError:"Connection error",authorizationError:"Authorization error"},l={connecting:0,open:1,closing:2,closed:3},c={btn:"btn",btnPrimary:"btn-primary",btnPrimarySmall:"btn-primary_small",btnPrimaryExtraSmall:"btn-primary_extra-small",btnSecondary:"btn-secondary",btnSecondarySmall:"btn-secondary_small",input:"input",container:"container",inputField:"input-field",inputFieldInvalid:"input-field_invalid",inputFieldControl:"input-field__control",inputFieldMessage:"input-field__message",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",loginBlock:"login-block",loginForm:"login-form",primaryBtn:"btn-primary",loginPage:"login-page",loginPageInner:"login-page__inner",messengerPage:"messenger-page",messenger:"messenger",messengerHeader:"messenger-header",messengerHeaderButtons:"messenger-header__buttons",messengerFooter:"messenger-footer",messengerHistory:"messenger-history",messengerHistoryHeader:"messenger-history__header",messengerHistoryContent:"messenger-history__content",interlocutor:"interlocutor",interlocutorStatus:"interlocutor-status",InterlocutorStatusActive:"interlocutor-status_active",messengerUsers:"messenger-users",messengerCurrentLogin:"messenger__current-login",messengerTitle:"messenger__title",messengerTextForm:"messenger-text-form",page:"page",pageInner:"page__inner",pageInnerPlaceCenter:"page__inner_place-center",infoPage:"info-page",infoBlock:"info-block",InfoBlockReturnBtn:"info-block__return-btn",window:"window",usersList:"users-list",usersItem:"users-item",usersItemActive:"users-item_active",usersItemSelected:"users-item_selected",usersItemHidden:"users-item_hidden",usersListWrap:"users-list-wrap",list:"list",badge:"badge",message:"message",messageButtonsWrap:"message__buttons-wrap",messageIncome:"message_income",messageOutcome:"message_outcome",messageHeader:"message__header",messageContent:"message__content",messageFooter:"message__footer",messagesDivider:"messages-divider",messagesDividerText:"messages-divider__text",messageSender:"message__sender",messageDeleteBtn:"message__delete-btn",messageEditBtn:"message__edit-btn",modalBlock:"modal-block",modalBlockActive:"modal-block_active",backdrop:"backdrop",backdropActive:"backdrop_active",modalWindow:"modal-window",modalWindowTitle:"modal-window__title",modalWindowText:"modal-window__text",modalWindowContentWrap:"modal-window__content-wrap",loaderBlock:"loader-block",loader:"loader",logo:"logo",messengerFooterLogo:"messenger-footer__logo",messengerHistoryPlaceholder:"messenger-history__placeholder",notFoundPage:"not-found-page"},d=Object.entries(c).reduce(((e,[s,t])=>(e[s]=`.${t}`,e)),{}),g='Only english letters or "-" are allowable',u="First letter must be in uppercase",h="fun-chat",p="saved-user",m=3,w=4,E="The application is designed to demonstrate the Fun Chat task as part of the RSSchool JavaScript/Front-end 2023Q4 course",C={selectUser:"Select a user to chat with...",writeMessage:"Write your first message..."},b={dataUnread:"data-unread",dataLogin:"data-login"},v={online:"Online",offline:"Offline"},B={delivered:"Delivered",read:"Has been read",sended:"Sended",edited:"Edited"},S="Me",y="Trying to reconnect...",N={login:"/",messenger:"/messenger",about:"/about",notFound:"/not-found"},M="/polyakov-artem-JSFE2023Q4/fun-chat"},175:(e,s,t)=>{t.r(s),t.d(s,{App:()=>te,app:()=>ne});var n=t(895);class a{observers=[];constructor(e){this._value=e}setValue(e){this._value!==e&&(this._value=e,this.notifyAll(e))}getValue(){return this._value}subscribe(e){this.observers.push(e)}unsubscribe(e){const s=this.observers.indexOf(e);-1!==s&&this.observers.splice(s,1)}notifyAll(e){for(const s of this.observers)s(e)}unsubscribeAll(){this.observers.length=0}}const A=new class{constructor(){this.editableMessage=null,this.login=null,this.password=null,this.isConnected=!1,this.selectedUser=null,this.currentMessages=null,this.currentUnreadMessages=null,this.allSendersHistory=null,this.allUsers=null,Object.keys(this).forEach((e=>{this[e]=new a(this[e])}))}},r=new class{constructor(){this.webSocket=null,this.tasksMap=new Map,this.timer=null,this.requestNumber=0}get requestId(){const e=this.requestNumber;return this.requestNumber+=1,`${e}`}addOnOpenCallback(e){this.openCb=e}addOnCloseCallback(e){this.closeCb=e}addOnErrorCallback(e){this.errorCb=e}addServerRequestHandler(e){this.serverRequestHandler=e}closeConnection(){this.webSocket?.close()}autoConnect(){clearInterval(this.timer),this.connect(),this.timer=setInterval((()=>{this.webSocket||this.connect()}),n.CONNECTION_CHECK_INTERVAL)}getWebSocket(){return this.webSocket}connect(){this.webSocket=new WebSocket(`ws://${n.SERVER_ADDRESS}:${n.SERVER_PORT}`),this.webSocket.onopen=e=>{this.webSocket.readyState===n.webSocketReadyStates.open&&(console.log(n.webServiceMessages.onOpen),this.openCb?.(e))},this.webSocket.onclose=e=>{console.log(n.webServiceMessages.onClose),this.webSocket=null,this.clearTasks(),this.closeCb?.(e)},this.webSocket.onerror=e=>{console.warn(n.webServiceMessages.connectionError),this.errorCb?.(e)},this.webSocket.onmessage=e=>{this.handleWebsocketMessage(e)}}handleWebsocketMessage(e){const s=e?.data;if(!s)return void console.warn(n.webServiceMessages.noDataInResponse,e);const t=JSON.parse(s),{id:a}=t,A=this.tasksMap.get(a);A?this.handleResponse(a,A,t):this.handleRequest(t)}handleResponse(e,s,t){s.resolve(t),this.tasksMap.delete(e)}handleRequest(e){this.serverRequestHandler?.(e)}login(e,s){return this.sendData({type:n.serverResponseTypes.userLogin,payload:{user:{login:e,password:s}}})}logout(e,s){return this.clearTasks(),this.sendData({type:n.serverResponseTypes.userLogout,payload:{user:{login:e,password:s}}})}clearTasks(){const e=new Map(this.tasksMap);this.tasksMap.clear();for(const s of e.values())s.resolve({type:n.serverResponseTypes.error,payload:{error:n.webServiceMessages.taskAborted}})}getAllAuthenticated(){return this.sendData({type:n.serverResponseTypes.userActive,payload:null})}getAllUnauthorized(){return this.sendData({type:n.serverResponseTypes.userInactive,payload:null})}sendText(e,s){return this.sendData({type:n.serverResponseTypes.msgSend,payload:{message:{to:e,text:s}}})}getMessagesFrom(e){return this.sendData({type:n.serverResponseTypes.msgFromUser,payload:{user:{login:e}}})}setStatusRead(e){return this.sendData({type:n.serverResponseTypes.msgRead,payload:{message:{id:e}}})}deleteMessage(e){return this.sendData({type:n.serverResponseTypes.msgDelete,payload:{message:{id:e}}})}changeText(e,s){return this.sendData({type:n.serverResponseTypes.msgEdit,payload:{message:{text:s,id:e}}})}sendData(e){if(!this.webSocket||this.webSocket.readyState!==n.webSocketReadyStates.open)return Promise.resolve({type:n.serverResponseTypes.error,payload:{error:n.webServiceMessages.noConnection}});const s=this.requestId;e.id=s;const t={};return t.promise=new Promise((e=>{t.resolve=e})),this.tasksMap.set(s,t),this.webSocket.send(JSON.stringify(e)),t.promise}};var o=t(845);class i{childComponents=[];node=null;constructor({tag:e="div",classNames:s=[],text:t="",attr:n={}}={}){const a=document.createElement(e);a.classList.add(...s),a.textContent=t,Object.keys(n).forEach((e=>{a.setAttribute(e,n[e])})),this.node=a,this.node.component=this}appendComponents(...e){e.forEach((e=>{this.childComponents.push(e),this.node.append(e.node)}))}prependComponents(...e){e.forEach((e=>{this.childComponents.push(e),this.node.prepend(e.node)}))}setTextContent(e){this.node.textContent=e}getTextContent(){return this.node.textContent}setValue(e){this.node.value=e}getValue(){return this.node.value}disable(){this.setAttribute("disabled","true")}enable(){this.removeAttribute("disabled")}setAttribute(e,s){this.node.setAttribute(`${e}`,`${s}`)}getAttribute(e){return this.node.getAttribute(e)}removeAttribute(e){this.node.removeAttribute(e)}toggleClass(e){this.node.classList.toggle(e)}addClass(e){this.node.classList.add(e)}removeClass(e){this.node.classList.remove(e)}addEventListener(e,s,t=!1){this.node.addEventListener(e,s,t)}removeComponents(){this.childComponents.forEach((e=>{e.remove()})),this.childComponents.length=0}remove(){this.removeComponents(),this.node.remove()}}class l extends i{constructor(e={}){e.tag="button",e.classNames??=[],e.classNames.push(n.classes.btn),super(e)}}class c extends i{constructor(e={}){e.tag="h3",super(e)}}class d extends i{constructor(e={}){e.tag="p",super(e)}}class g extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.modalBlock),super(e),this.init(e)}init(e){const{closeable:s,title:t,text:a}=e.message;this.backdrop=new i({classNames:[n.classes.backdrop]});const A=new i({classNames:[n.classes.modalWindow,n.classes.window]});if(t){const e=new c({text:t,classNames:[n.classes.modalWindowTitle,n.classes.h1]});A.appendComponents(e)}if(a){const e=new d({text:a,classNames:[n.classes.modalWindowText,n.classes.h5]});A.appendComponents(e)}this.contentWrap=new i({classNames:[n.classes.modalWindowContentWrap]}),A.appendComponents(this.contentWrap),s&&(this.closeBtn=new l({text:"Close",classNames:[n.classes.btnPrimary]}),A.appendComponents(this.closeBtn),this.addEventListeners()),this.appendComponents(A)}addContent(e){this.contentWrap.appendComponents(e)}addEventListeners(){this.closeBtn.addEventListener("click",(()=>{this.close()}))}open(){document.body.append(this.node),this.lockScroll()}close(){this.node.remove(),document.body.querySelector(n.classSelectors.modalBlock)||this.unlockScroll}lockScroll(){const e=window.innerWidth-document.body.clientWidth;document.body.style.height="100%",document.body.style.overflow="hidden%",e&&(document.body.style.paddingRight=`${e}px`)}unlockScroll(){document.body.style.paddingRight="",document.body.style.height="",document.body.style.overflow=""}}class u extends g{constructor(e={}){e.message??={},e.message.title??="Error",e.message.closeable=!0,super(e)}}const h=new class{validateInput(e,s=3){return/[^a-zA-Z-]/g.test(e)?n.INVALID_CHARS_TEXT:e.length<s?this.getInvalidLengthText(s):e[0]!==e[0].toUpperCase()?n.INVALID_LETTER_TEXT:""}getInvalidLengthText(e){return`The length must be at least ${e} characters`}autoLogin(){const e=o.PL.getData(n.AUTH_DATA_KEY);if(!e||!e.login||!e.password)return void this.removeStorageAuthData();const s=this.validateInput(e.login,n.LOGIN_MIN_LENGTH),t=this.validateInput(e.password,n.PASSWORD_MIN_LENGTH);s||t?this.removeStorageAuthData():this.login(e.login,e.password)}async login(e,s){const t=await r.login(e,s);if(t.type!==n.serverResponseTypes.error)A.login.setValue(e),A.password.setValue(s),o.PL.saveData(n.AUTH_DATA_KEY,{login:e,password:s});else{const e=t.payload.error;new u({message:{title:n.errorsNames.authorizationError,text:e}}).open()}}logout(){r.logout(A.login.getValue(),A.password.getValue()),this.removeAppAuthData(),this.removeStorageAuthData()}removeAppAuthData(){A.login.setValue(null),A.password.setValue(null)}removeStorageAuthData(){o.PL.removeData(n.AUTH_DATA_KEY)}},p=new class{async sendText(e){const s=A.selectedUser.getValue();if(!e||!s)return;const t=A.currentUnreadMessages.getValue();await r.sendText(s.login,e),t?this.readCurrentMessages():this.updateAllSendersHistory()}async changeText(e,s){e&&s&&(this.updateEditableMessage(),await r.changeText(e,s),this.updateAllSendersHistory())}updateSelectedUser(e){const s=A.allUsers.getValue();if(!s||null===e)return void A.selectedUser.setValue(null);if(e){const t=s.find((s=>s.login===e));return void A.selectedUser.setValue(t)}const t=A.selectedUser.getValue()?.login;if(t){const e=s.find((e=>e.login===t));A.selectedUser.setValue(e)}}async updateAllSendersHistory(){const e=A.allUsers.getValue();if(!e)return void A.allSendersHistory.setValue(null);const s=e.map((e=>this.getMessagesWithUser(e.login))),t=await Promise.all(s);A.allSendersHistory.setValue(t)}async getMessagesWithUser(e){const s=await r.getMessagesFrom(e);return s.type===n.serverResponseTypes.error?{login:e,messages:[]}:{login:e,messages:s.payload.messages}}updateCurrentMessages(){const e=A.selectedUser.getValue(),s=A.allSendersHistory.getValue();if(!e||!s)return void A.currentMessages.setValue(null);const t=s.find((s=>s.login===e.login));t.messages.length?A.currentMessages.setValue(t.messages):A.currentMessages.setValue(null)}updateCurrentUnreadMessages(){const e=A.currentMessages.getValue();if(!e)return void A.currentUnreadMessages.setValue(null);const s=A.login.getValue(),t=e.filter((e=>e.to==s&&!1===e.status.isReaded));t.length?A.currentUnreadMessages.setValue(t):A.currentUnreadMessages.setValue(null)}async updateAllUsers(){const e=A.login.getValue();if(!e)return void A.allUsers.setValue(null);const s=await r.getAllAuthenticated(),t=await r.getAllUnauthorized();if(s.type===n.serverResponseTypes.error||t.type===n.serverResponseTypes.error)return;const a=s.payload?.users,o=a.filter((s=>s.login!==e)),i=t.payload?.users;A.allUsers.setValue([...o,...i])}async readCurrentMessages(){const e=A.currentUnreadMessages.getValue();e&&(await Promise.all(e.map((e=>r.setStatusRead(e.id)))),A.currentUnreadMessages.setValue(null),this.updateAllSendersHistory())}async deleteMessage(e){this.updateEditableMessage(),await r.deleteMessage(e),this.updateAllSendersHistory()}updateEditableMessage(e){e?A.editableMessage.setValue(e):A.editableMessage.setValue(null)}},m=new class{constructor(e){this.publicPath=e,this.routes=[],this.addEventListeners()}addEventListeners(){window.addEventListener("popstate",(()=>{this.navigate()}))}addRoutes(e){this.routes=e}navigate(e){"string"==typeof e&&this.setHistory(e);const s=this.getPath();console.log("path",s);let t=this.routes.find((e=>(console.log("item.path",e.path),e.path===s)));t||(t=this.routes.find((e=>e.path===n.pagesPaths.notFound))),t?.callback?.()}setHistory(e){history.pushState(null,null,`${this.publicPath}${e}`)}getPath(){return window.location.pathname.replace(this.publicPath,"")}}(n.PUBLIC_PATH),w=new class{constructor(){this.connectionService=r,this.storageService=o.PL,this.authController=h,this.messengerController=p,this.routingService=m,this.addConnectionListeners(),this.addModelListeners()}addConnectionListeners(){this.connectionService.addOnOpenCallback((()=>{A.isConnected.setValue(!0)})),this.connectionService.addOnCloseCallback((()=>{A.isConnected.setValue(!1)})),this.connectionService.addServerRequestHandler((e=>{switch(e.type){case n.serverResponseTypes.userExternalLogin:case n.serverResponseTypes.userExternalLogout:this.messengerController.updateAllUsers();break;case n.serverResponseTypes.msgSend:case n.serverResponseTypes.msgDelete:case n.serverResponseTypes.msgEdit:case n.serverResponseTypes.msgRead:this.messengerController.updateAllSendersHistory()}}))}addModelListeners(){this.addConnectionChangeListeners(),this.addLoginListeners(),this.addUsersChangeListeners(),this.addSendersHistoryListeners(),this.addSelectionListeners(),this.addCurrentMessagesListeners()}addConnectionChangeListeners(){A.isConnected.subscribe((e=>{e?this.authController.autoLogin():this.authController.removeAppAuthData()}))}addLoginListeners(){A.login.subscribe((()=>{this.messengerController.updateAllUsers()}))}addUsersChangeListeners(){A.allUsers.subscribe((()=>{this.messengerController.updateAllSendersHistory(),this.messengerController.updateSelectedUser()}))}addSendersHistoryListeners(){A.allSendersHistory.subscribe((()=>{this.messengerController.updateCurrentMessages()}))}addSelectionListeners(){A.selectedUser.subscribe((()=>{this.messengerController.updateCurrentMessages(),this.messengerController.updateEditableMessage()}))}addCurrentMessagesListeners(){A.currentMessages.subscribe((()=>{this.messengerController.updateCurrentUnreadMessages()}))}};class E extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.page),super(e)}redraw(){document.body.querySelectorAll("body > *:not(script)").forEach((e=>e.remove())),document.body.append(this.node)}}class C extends i{constructor(e={}){e.tag="form",e.attr??={},e.attr.action??="",super(e)}}class b extends i{constructor(e={}){e.tag="label",super(e)}}class v extends i{constructor(e={}){e.tag="input",e.classNames??=[],e.classNames.push(n.classes.input),super(e)}}class B extends C{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.loginForm),super(e),this.init(),this.addEventListeners(),this.addModelListeners()}init(){const e=new b({text:"Login",classNames:[n.classes.h4]}),s=new b({text:"Password",classNames:[n.classes.h4]});this.loginField=new i({classNames:[n.classes.inputField]}),this.passwordField=new i({classNames:[n.classes.inputField]}),this.loginInput=new v({classNames:[n.classes.inputFieldControl]}),this.passwordInput=new v({classNames:[n.classes.inputFieldControl]}),this.loginMessageElement=new d({classNames:[n.classes.inputFieldMessage]}),this.passwordMessageElement=new d({classNames:[n.classes.inputFieldMessage]}),this.loginBtn=new l({text:"Login",classNames:[n.classes.btnPrimary],attr:{disabled:!0}}),this.appendComponents(e,this.loginField,s,this.passwordField,this.loginBtn),this.loginField.appendComponents(this.loginInput,this.loginMessageElement),this.passwordField.appendComponents(this.passwordInput,this.passwordMessageElement)}addEventListeners(){this.node.addEventListener("input",(e=>{const s=this.validateInputs();e.target===this.loginInput.node?this.updateFieldState(this.loginField,this.loginMessageElement,s.loginError):this.updateFieldState(this.passwordField,this.passwordMessageElement,s.passwordError),this.updateBtnState(s)})),this.addEventListener("submit",(e=>(e.preventDefault(),h.login(this.loginInput.getValue(),this.passwordInput.getValue()),!1)))}addModelListeners(){A.login.subscribe((e=>e&&this.clearFields()))}validateInputs(){return{loginError:h.validateInput(this.loginInput.getValue(),n.LOGIN_MIN_LENGTH),passwordError:h.validateInput(this.passwordInput.getValue(),n.PASSWORD_MIN_LENGTH)}}updateBtnState(e){e.loginError||e.passwordError?this.loginBtn.disable():this.loginBtn.enable()}updateFieldState(e,s,t){t?e.addClass(n.classes.inputFieldInvalid):e.removeClass(n.classes.inputFieldInvalid),s.setTextContent(t)}clearFields(){this.loginInput.setValue(""),this.passwordInput.setValue(""),this.loginBtn.disable()}}class S extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.loginBlock,n.classes.window),super(e),this.init(),this.addEventListeners()}init(){this.loginForm=new B,this.infoBtn=new l({text:"About",classNames:[n.classes.btnPrimary]}),this.appendComponents(this.loginForm,this.infoBtn)}addEventListeners(){this.infoBtn.addEventListener("click",(()=>{m.navigate(n.pagesPaths.about)}))}}const y=new class extends E{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.loginPage),super(e),this.init()}init(){this.pageInner=new i({classNames:[n.classes.pageInner,n.classes.pageInnerPlaceCenter,n.classes.container]}),this.loginBlock=new S,this.appendComponents(this.pageInner),this.pageInner.appendComponents(this.loginBlock)}};class N extends i{constructor(e={}){e.tag="h1",super(e)}}const M=new class extends E{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.notFoundPage),super(e),this.init(),this.addEventListeners()}init(){const e=new i({classNames:[n.classes.pageInner,n.classes.pageInnerPlaceCenter,n.classes.container]}),s=new i({classNames:[n.classes.window,n.classes.infoBlock]}),t=new N({text:"404",classNames:[n.classes.h1]}),a=new d({text:"Page not found. That page doesn't exist"});this.returnBtn=new l({text:"To main",classNames:[n.classes.btnPrimary]}),this.appendComponents(e),e.appendComponents(s),s.appendComponents(t,a,this.returnBtn)}addEventListeners(){this.returnBtn.addEventListener("click",(()=>{A.login.getValue()?m.navigate(n.pagesPaths.messenger):m.navigate(n.pagesPaths.login)}))}};class I extends i{constructor(e={}){e.tag="span",super(e)}}class R extends i{constructor(e={}){e.tag="img",e.attr??={},e.alt&&(e.attr.alt=e.alt),super(e)}}class L extends i{constructor(e={}){e.tag="a",e.attr??={},e.attr.href??="",e.attr.target??="_blank",super(e)}}class x extends i{constructor(){super({classNames:[n.classes.messengerFooter]}),this.init()}init(){const e=new R({classNames:[n.classes.logo],attr:{alt:"Logo",src:"data:image/webp;base64,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"}}),s=new i({classNames:[n.classes.messengerFooterLogo]}),t=new L({text:"Polyakov Artem",attr:{href:"https://github.com/polyakov-artem"}}),a=new I({text:"RS School"}),A=new I({text:"2024"});s.appendComponents(e,a),this.appendComponents(s,A,t)}}class U extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.infoBlock,n.classes.window),super(e),this.init(),this.addEventListeners()}init(){const e=new N({text:"Fun Chat",classNames:[n.classes.h1]}),s=new d({text:n.ABOUT_APP_TEXT});this.returnBtn=new l({text:"Return",classNames:[n.classes.btnPrimary,n.classes.InfoBlockReturnBtn]});const t=new L({text:"Author: Polyakov Artem",attr:{href:"https://github.com/polyakov-artem"}});this.appendComponents(e,s,t,this.returnBtn)}addEventListeners(){this.returnBtn.addEventListener("click",(()=>{A.login.getValue()?m.navigate(n.pagesPaths.messenger):m.navigate(n.pagesPaths.login)}))}}const k=new class extends E{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.infoPage),super(e),this.init()}init(){this.pageInner=new i({classNames:[n.classes.pageInner,n.classes.pageInnerPlaceCenter,n.classes.container]}),this.infoBlock=new U,this.appendComponents(this.pageInner),this.pageInner.appendComponents(this.infoBlock)}};class D extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.messengerHeader),super(e),this.init(),this.addEventListeners(),this.addModelListeners()}init(){this.userLogin=new I({classNames:[n.classes.messengerCurrentLogin,n.classes.h4]});const e=new N({text:"Fun chat",classNames:[n.classes.h1]}),s=new i({classNames:[n.classes.messengerHeaderButtons]});this.logoutBtn=new l({text:"Logout",classNames:[n.classes.btnPrimary,n.classes.btnPrimarySmall]}),this.infoBtn=new l({text:"About",classNames:[n.classes.btnPrimary,n.classes.btnPrimarySmall]}),s.appendComponents(this.infoBtn,this.logoutBtn),this.appendComponents(this.userLogin,e,s)}addEventListeners(){this.logoutBtn.addEventListener("click",(()=>{h.logout()})),this.infoBtn.addEventListener("click",(()=>{m.navigate(n.pagesPaths.about)}))}addModelListeners(){A.login.subscribe((e=>{const s=`User: ${e||""}`;this.userLogin.setTextContent(s)}))}}class T extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.messengerHistoryHeader),super(e),this.init(),this.addModelListeners()}addModelListeners(){A.selectedUser.subscribe((e=>{this.update(e)}))}init(){this.Interlocutor=new I({classNames:[n.classes.interlocutor]}),this.InterlocutorStatus=new I({classNames:[n.classes.interlocutorStatus]}),this.appendComponents(this.Interlocutor,this.InterlocutorStatus)}update(e){let s="";if(!e)return this.Interlocutor.setTextContent(""),void this.InterlocutorStatus.setTextContent(s);e.isLogined?(s=n.userStatuses.online,this.InterlocutorStatus.addClass(n.classes.InterlocutorStatusActive)):(s=n.userStatuses.offline,this.InterlocutorStatus.removeClass(n.classes.InterlocutorStatusActive)),this.Interlocutor.setTextContent(`Receiver: ${e.login}`),this.InterlocutorStatus.setTextContent(s)}}class P extends l{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.btnPrimary),e.isSmall&&e.classNames.push(n.classes.btnPrimarySmall),e.isExtraSmall&&e.classNames.push(n.classes.btnPrimaryExtraSmall),super(e)}}class F extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.messageHeader),super(e),this.init(e)}init(e){const{senderString:s,dateString:t,isOutcome:a}=e.message,A=new I({text:s,classNames:[n.classes.messageSender]}),r=new I({text:t});if(a){const e=new i({classNames:[n.classes.messageButtonsWrap]}),s=new P({text:"Edit",isExtraSmall:!0,classNames:[n.classes.messageEditBtn]}),t=new P({text:"Delete",isExtraSmall:!0,classNames:[n.classes.messageDeleteBtn]});return e.appendComponents(s,t),void this.appendComponents(e,A,r)}this.appendComponents(A,r)}}class Q extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.messageFooter),super(e),this.init(e)}init(e){const{editedString:s,statusString:t}=e.message,n=new I({text:s}),a=new I({text:t});this.appendComponents(n,a)}}class f extends i{constructor(e={}){e.tag="article",e.classNames??=[],e.classNames.push(n.classes.message),super(e),this.init(e)}init(e){const{datetime:s,from:t,id:a,status:r,text:o}=e.message,{isDelivered:l,isReaded:c,isEdited:d}=r;this.id=a;const g=A.login.getValue()===t,u=g?n.MESSAGE_USER_ALIAS:t,h=`${new Date(s).toLocaleDateString()}, ${new Date(s).toLocaleTimeString()}`,p=d?n.messageStatuses.edited:"";let m="";g&&(m=n.messageStatuses.sended,l&&(m=n.messageStatuses.delivered),c&&(m=n.messageStatuses.read)),g?this.addClass(n.classes.messageOutcome):this.addClass(n.classes.messageIncome);const w=new F({message:{senderString:u,dateString:h,isOutcome:g}}),E=new Q({message:{editedString:p,statusString:m}});this.messageContent=new i({text:o,classNames:[n.classes.messageContent]}),this.appendComponents(w,this.messageContent,E)}}class G extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.messagesDivider),super(e),this.init()}init(){const e=new d({text:"New messages",classNames:[n.classes.messagesDividerText]});this.appendComponents(e)}}class H extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.messengerHistoryContent),super(e),this.init(),this.addModelListeners(),this.addEventListeners()}init(){this.selectUserPlaceholder=new d({classNames:[n.classes.messengerHistoryPlaceholder],text:n.historyPlaceholders.selectUser}),this.writeMessagePlaceholder=new d({classNames:[n.classes.messengerHistoryPlaceholder],text:n.historyPlaceholders.writeMessage}),this.appendComponents(this.selectUserPlaceholder),this.autoScrolling=!1}addModelListeners(){A.currentMessages.subscribe((()=>{this.update()})),A.selectedUser.subscribe((()=>{this.update()}))}addEventListeners(){this.addEventListener("click",(e=>{this.handleClick(e)})),this.addEventListener("scroll",(e=>{this.handleScroll(e)})),this.addEventListener("scrollend",(e=>{this.autoScrolling=!1}))}update(){if(this.removeComponents(),!A.selectedUser.getValue())return void this.appendComponents(this.selectUserPlaceholder);const e=A.currentMessages.getValue();e?(this.addMessages(e),this.scrollView()):this.appendComponents(this.writeMessagePlaceholder)}addMessages(e){this.dividerIsAdded=!1,e.forEach((e=>{this.dividerIsAdded||e.status.isReaded||e.to!==A.login.getValue()||(this.messageDivider=new G,this.appendComponents(this.messageDivider),this.dividerIsAdded=!0),this.appendComponents(new f({message:e}))}))}scrollView(){this.autoScrolling=!0,this.dividerIsAdded?this.messageDivider.node.scrollIntoView():this.childComponents[this.childComponents.length-1].node.scrollIntoView()}handleClick(e){p.readCurrentMessages();const s=e?.target?.closest(n.classSelectors.message);s&&this.handleMessageClick(s,e)}handleMessageClick(e,s){const t=e.component,{id:a}=t,A=s?.target?.closest(n.classSelectors.messageDeleteBtn);if(A)return void p.deleteMessage(a);const r=s?.target?.closest(n.classSelectors.messageEditBtn);if(r){const e=t.messageContent.getTextContent();p.updateEditableMessage({id:a,text:e})}}handleScroll(){this.autoScrolling||p.readCurrentMessages()}}class V extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.messengerHistory),super(e),this.init()}init(){const e=new T,s=new H;this.appendComponents(e,s)}}class O extends i{constructor(e={}){e.tag="ul",e.classNames??=[],e.classNames.push(n.classes.list),super(e)}}class W extends i{constructor(e={}){e.tag="li",super(e)}}class Z extends I{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.badge),super(e)}}class Y extends W{constructor(e={}){const{sender:s,numOfUnread:t,isVisible:a,isActive:A,isSelected:r}=e;super({text:s,classNames:[n.classes.usersItem]}),A&&this.addClass(n.classes.usersItemActive),r&&this.addClass(n.classes.usersItemSelected),!a&&this.addClass(n.classes.usersItemHidden),this.sender=s,this.init(t)}init(e){if(e){const s=new Z({text:e});this.appendComponents(s)}}}class K extends O{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.usersList),super(e)}update(e,s,t,n,a){this.removeComponents(),e&&s&&e.forEach(((e,A)=>{const r=e.login,{messages:o}=e,i=n===r,l=r.toLowerCase().includes(t.toLowerCase()),c=s[A].isLogined,d=o.reduce(((e,s)=>s.from===a||s.status.isReaded?e:e+1),0);this.appendComponents(new Y({sender:r,numOfUnread:d,isVisible:l,isActive:c,isSelected:i}))}))}}class J extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.messengerUsers),super(e),this.init(),this.addModelListeners(),this.addEventListeners()}init(){this.searchField=new v;const e=new i({classNames:[n.classes.usersListWrap]});this.usersList=new K,e.appendComponents(this.usersList),this.appendComponents(this.searchField,e)}addEventListeners(){this.searchField.addEventListener("input",(()=>{this.updateUsersList()})),this.usersList.addEventListener("click",(e=>{this.selectUser(e)}))}selectUser(e){const s=e?.target?.closest(n.classSelectors.usersItem);s?p.updateSelectedUser(s.component.sender):p.updateSelectedUser(null)}addModelListeners(){A.allSendersHistory.subscribe((()=>{this.updateUsersList()})),A.selectedUser.subscribe((()=>{this.updateUsersList()}))}updateUsersList(){const e=A.login.getValue(),s=A.selectedUser.getValue()?.login,t=this.searchField.getValue(),n=A.allSendersHistory.getValue(),a=A.allUsers.getValue();this.usersList.update(n,a,t,s,e)}}class q extends v{constructor(e={}){super(e),this.addModelListeners()}addModelListeners(){A.editableMessage.subscribe((e=>{this.update(e)}))}update(e){e&&this.setValue(e.text)}}class _ extends C{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.messengerTextForm),super(e),this.init(),this.addEventListeners(),this.addModelListeners()}init(){this.input=new q({attr:{disabled:!0}}),this.sendBtn=new P({text:"Send",isSmall:!0,attr:{disabled:!0}}),this.appendComponents(this.input,this.sendBtn)}addModelListeners(){A.selectedUser.subscribe((e=>{this.update(e)}))}addEventListeners(){this.addEventListener("submit",(e=>{e.preventDefault();const s=A.editableMessage.getValue(),t=this.input.getValue();if(s){const{id:e}=s;p.changeText(e,t)}else p.sendText(t);return this.input.setValue(""),!1}))}update(e){if(this.input.setValue(""),e)return this.input.enable(),void this.sendBtn.enable();this.input.disable(),this.sendBtn.disable()}}class X extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.messenger,n.classes.window),super(e),this.init()}init(){this.messengerHeader=new D,this.messengerFooter=new x,this.messengerHistory=new V,this.messengerUsers=new J,this.messengerForm=new _,this.appendComponents(this.messengerHeader,this.messengerFooter,this.messengerHistory,this.messengerUsers,this.messengerForm)}}const z=new class extends E{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.messengerPage),super(e),this.init()}init(){this.pageInner=new i({classNames:[n.classes.pageInner,n.classes.pageInnerPlaceCenter,n.classes.container]}),this.messenger=new X,this.appendComponents(this.pageInner),this.pageInner.appendComponents(this.messenger)}};class j extends i{constructor(e={}){e.classNames??=[],e.classNames.push(n.classes.loader),super(e)}}class $ extends i{constructor(e={}){e.text??=n.RECONNECTION_ERROR_TEXT,e.classNames??=[],e.classNames.push(n.classes.loaderBlock),super(e),this.init()}init(){this.appendComponents(new j)}}class ee extends g{constructor(e={}){e.message??={},e.message.title=n.errorsNames.connectionError,e.message.closeable=!1,super(e),this.addContent(new $)}}const se=new class{constructor(){this.loginPage=y,this.messengerPage=z,this.infoPage=k,this.notFoundPage=M,this.addRoutes(),this.init(),this.addModelListeners()}addRoutes(){m.addRoutes([{path:n.pagesPaths.login,callback:()=>{A.login.getValue()?m.navigate(n.pagesPaths.messenger):this.loginPage.redraw()}},{path:n.pagesPaths.about,callback:()=>{this.infoPage.redraw()}},{path:n.pagesPaths.messenger,callback:()=>{A.login.getValue()?this.messengerPage.redraw():m.navigate(n.pagesPaths.login)}},{path:n.pagesPaths.notFound,callback:()=>{this.notFoundPage.redraw()}}])}init(){m.navigate(null),this.reconnectionModalBlock=new ee,this.reconnectionModalBlock.open()}addModelListeners(){A.login.subscribe((e=>{const s=m.getPath(),t=Object.values(n.pagesPaths),a=t.filter((e=>e!==n.pagesPaths.login)),A=t.filter((e=>e!==n.pagesPaths.messenger));e&&a.includes(s)||!e&&A.includes(s)||(e||s!==n.pagesPaths.messenger?e&&s===n.pagesPaths.login&&m.navigate(n.pagesPaths.messenger):m.navigate(n.pagesPaths.login))})),A.isConnected.subscribe((e=>{e?this.reconnectionModalBlock.close():this.reconnectionModalBlock.open()}))}};class te{constructor(){this.appModel=A,this.appController=w,this.appView=se,this.init()}init(){r.autoConnect()}}const ne=new te}},s={};function t(n){var a=s[n];if(void 0!==a)return a.exports;var A=s[n]={exports:{}};return e[n](A,A.exports,t),A.exports}t.d=(e,s)=>{for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})},t.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=t(175);document.addEventListener("DOMContentLoaded",(()=>{new e.App}))})()})();